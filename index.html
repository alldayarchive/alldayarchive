<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AllDay Archive | Your Daily Knowledge Vault</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #050505; color: #fff; scroll-behavior: smooth; }
        .font-hud { font-family: 'Orbitron', sans-serif; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; }
        .tab-btn { padding: 10px 20px; border-radius: 10px; font-size: 10px; font-family: 'Orbitron'; border: 1px solid #333; transition: 0.3s; }
        .tab-btn.active { background: #38bdf8; color: #000; border-color: #38bdf8; }
        #content-area { display: none; }
    </style>
</head>
<body class="p-6 md:p-12">
    <nav class="flex justify-between items-center mb-16 border-b border-white/5 pb-6">
        <div class="font-hud text-xl font-black text-sky-400">ALLDAY ARCHIVE</div>
        <div class="text-[9px] font-hud text-gray-500">GLOBAL DATA CENTER</div>
    </nav>

    <main class="max-w-5xl mx-auto space-y-16">
        <!-- Hero Search -->
        <section class="text-center space-y-8">
            <h1 class="text-5xl md:text-7xl font-hud font-black uppercase tracking-tight">Access <span class="text-sky-500">History</span></h1>
            <div class="glass p-4 flex flex-col md:flex-row gap-4">
                <input type="date" id="dateInput" class="flex-1 bg-transparent text-2xl font-hud outline-none text-center">
                <button onclick="handleScan()" class="bg-sky-500 text-black px-12 py-4 rounded-xl font-hud font-black hover:bg-white transition-all">SCAN</button>
            </div>
        </section>

        <!-- Dynamic Content -->
        <div id="content-area" class="space-y-10">
            <!-- Category Tabs & Internal Search -->
            <div class="flex flex-wrap justify-between items-center gap-6 glass p-6">
                <div class="flex flex-wrap gap-2">
                    <button class="tab-btn active" onclick="filter('all')">ALL</button>
                    <button class="tab-btn" onclick="filter('holidays')">HOLIDAYS</button>
                    <button class="tab-btn" onclick="filter('innovations')">TECH/INNOV</button>
                    <button class="tab-btn" onclick="filter('arts')">ARTS/LIT</button>
                    <button class="tab-btn" onclick="filter('pop_culture')">POP CULTURE</button>
                </div>
                <input type="text" id="innerSearch" onkeyup="searchWithin()" placeholder="Search within this day..." class="bg-white/5 border border-white/10 p-2 rounded-lg text-xs outline-none focus:border-sky-400 w-full md:w-64">
            </div>

            <!-- Result Cards -->
            <div id="cards-container" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Cards will be injected here -->
            </div>
        </div>
    </main>

    <script>
        const SB_URL = "여기에_수파베이스_주소";
        const SB_KEY = "여기에_아논_공개키";
        const supabase = supabase.createClient(SB_URL, SB_KEY);
        let currentData = null;

        async function handleScan() {
            const dateVal = document.getElementById('dateInput').value;
            if(!dateVal) return alert("Select Date");
            const mDay = dateVal.substring(5);

            const { data, error } = await supabase.from('daily_archives').select('*').eq('date_id', mDay).single();
            if(error || !data) return alert("Searching Deep Archive...");

            currentData = data;
            document.getElementById('content-area').style.display = 'block';
            displayData('all');
            document.getElementById('content-area').scrollIntoView({ behavior: 'smooth' });
        }

        function displayData(category) {
            const container = document.getElementById('cards-container');
            container.innerHTML = "";
            
            // 데이터 매핑 로직 (모든 카테고리 순회)
            const categories = ['holidays', 'innovations', 'arts', 'pop_culture'];
            categories.forEach(cat => {
                if(category === 'all' || category === cat) {
                    const items = currentData[cat] || [];
                    items.forEach(item => {
                        container.innerHTML += `
                            <div class="glass p-8 space-y-4 border-l-4 border-sky-500 card-item">
                                <span class="text-[9px] font-hud text-sky-400 uppercase">${cat.replace('_',' ')}</span>
                                <p class="text-lg font-bold leading-relaxed">${item.text || item}</p>
                            </div>
                        `;
                    });
                }
            });
        }

        function filter(cat) {
            const btns = document.querySelectorAll('.tab-btn');
            btns.forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            displayData(cat);
        }

        function searchWithin() {
            const query = document.getElementById('innerSearch').value.toLowerCase();
            const cards = document.querySelectorAll('.card-item');
            cards.forEach(card => {
                card.style.display = card.innerText.toLowerCase().includes(query) ? 'block' : 'none';
            });
        }
    </script>
</body>
</html>
